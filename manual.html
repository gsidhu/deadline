<!-- manually coded calendar with no colours -->

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Meet your deadline.">
    <meta name="author" content="Gurjot Sidhu">
    <title>Deadline</title>

    <link rel="canonical" href="https://thatgurjot.com/deadline/sept.html">
  <title>Deadline</title>
  <!-- Bootstrap v5.2.0 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
  <!-- JavaScript Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
  <!-- Confetti animation -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  <!-- jQuery 3.6.0 -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <!-- HTML Calendar -->
  <script src="./calendar.js"></script>
  <style>
    th, td {
      text-align: center;
    }
    .red {
      background-color: #dc3545 !important;
      color: white;
    }
    .green {
      background-color: #198754 !important;
      color: white;
    }
    #yes-msg, #no-msg, #modal-done-text {
      display: none;
    }
    #progress-done {
      color: white;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="navbar navbar-dark bg-dark shadow-sm">
      <div class="container">
        <div href="#" class="navbar-brand d-flex align-items-center">
          <div>
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-mortarboard mx-2" viewBox="0 0 16 16"><path d="M8.211 2.047a.5.5 0 0 0-.422 0l-7.5 3.5a.5.5 0 0 0 .025.917l7.5 3a.5.5 0 0 0 .372 0L14 7.14V13a1 1 0 0 0-1 1v2h3v-2a1 1 0 0 0-1-1V6.739l.686-.275a.5.5 0 0 0 .025-.917l-7.5-3.5ZM8 8.46 1.758 5.965 8 3.052l6.242 2.913L8 8.46Z"/><path d="M4.176 9.032a.5.5 0 0 0-.656.327l-.5 1.7a.5.5 0 0 0 .294.605l4.5 1.8a.5.5 0 0 0 .372 0l4.5-1.8a.5.5 0 0 0 .294-.605l-.5-1.7a.5.5 0 0 0-.656-.327L8 10.466 4.176 9.032Zm-.068 1.873.22-.748 3.496 1.311a.5.5 0 0 0 .352 0l3.496-1.311.22.748L8 12.46l-3.892-1.556Z"/></svg>
          </div>
          <div>
            <span style="text-align: center;"><strong id="headline">Let's do this!</strong></span>
          </div>
        </div>
        <button class="navbar-toggler" type="button" data-bs-toggle="modal" data-bs-target="#exampleModal" aria-label="Open modal">
          <!-- <span class="navbar-toggler-icon"></span> -->
          <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16">
            <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/>
          </svg>
        </button>
      </div>
    </div>
    
  </header>
  
  <main>
    <!-- Hero container -->
    <section class="py-3 text-center container">
      <div class="row py-lg-4">
        <div class="col-xl-6 col-lg-8 mx-auto">
          <h1 class="fw-light py-2" id="msg">Did you write <span id="daily-word-target">900</span> words today?</h1>
          <h1 class="fw-light py-2" id="yes-msg">Yay! Way to go! <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" class="bi bi-suit-heart-fill" viewBox="0 0 16 16">
            <path d="M4 1c2.21 0 4 1.755 4 3.92C8 2.755 9.79 1 12 1s4 1.755 4 3.92c0 3.263-3.234 4.414-7.608 9.608a.513.513 0 0 1-.784 0C3.234 9.334 0 8.183 0 4.92 0 2.755 1.79 1 4 1z"/>
          </svg></h1>
          <h1 class="fw-light py-2" id="no-msg">Issokay bb I still love you :*</h1>
          <!-- Yes / No buttons -->
          <p class="py-2" id="yes-no-buttons">
            <button class="btn btn-success my-2 mx-3" style="width: 7rem; line-height: 2rem;" onclick="addWords(900)">Yes!</button>
            <button href="#" class="btn btn-warning my-2 mx-3" style="width: 7rem; line-height: 2rem;" onclick="noWords()">No</button>
          </p>

          <!-- Progress bars -->
          <div class="progress" style="height: 20px; line-height: 20px; font-size: 16px;">
            <div id="progress-done" class="progress-bar-striped bg-success progress-bar-animated" role="progressbar" aria-label="Segment one" style="width: 0%" aria-valuenow="15" aria-valuemin="0" aria-valuemax="100"></div>
            <div id="progress-left" class="progress-bar-striped bg-warning progress-bar-animated" role="progressbar" aria-label="Segment two" style="width: 100%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"></div>
          </div>

          <p id="words-msg" class="lead text-muted py-2">You have written <span id="words-written"></span> words so far and have <span id='words-left'></span> words left out of <span id='total-words'></span>.</p>
        </div>
      </div>

      <!-- Change word count and Celebrate buttons -->
      <div class="row row-cols-1 row-cols-md-2">
        <div class="col my-1">
          <button id="change-word-count-btn" class="btn btn-primary mx-2" onclick="toggleWordInput()">Change word count</button>
          <div id="word-input" class="col d-none  my-1 align-self-center">
            <form class="mx-2">
              <input id="word-count-input" type="number" style="width: 145px">
              <svg onclick="changeWordCount()" style="cursor: pointer;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-right-circle" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/></svg>
            </form>
          </div>
        </div>
        <div class="col my-1 align-self-center">
          <button id='celebrate-btn' class='btn btn-danger' onclick="celebrate()">Celebrate!</button>
        </div>
      </div>
    </section>

    <!-- Calendar -->
    <div class="album py-5 bg-light">
      <div class="container">
        <p class="text-center lead text-muted">You have <span id="days-left" style="text-decoration: underline;"></span><span style="text-decoration: underline;"> days</span> till your deadline (<span id='deadline-date'></span>).</p>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3 justify-content-center">
          <div class="col">
            <div class="card shadow-sm">
              <div class="card-body">
                <p class="text-center text-muted">August 2022</p>
                <p class="card-text">
                  <table class="table table-bordered">
                    <thead>
                      <tr>
                        <th scope="col">S</th>
                        <th scope="col">M</th>
                        <th scope="col">T</th>
                        <th scope="col">W</th>
                        <th scope="col">T</th>
                        <th scope="col">F</th>
                        <th scope="col">S</th>
                      </tr>
                    </thead>
                    <tbody class="table-group-divider">
                      <tr>
                        <td></td>
                        <td>1</td>
                        <td>2</td>
                        <td>3</td>
                        <td>4</td>
                        <td>5</td>
                        <td>6</td>
                      </tr>
                      <tr>
                        <td>7</td>
                        <td>8</td>
                        <td>9</td>
                        <td>10</td>
                        <td>11</td>
                        <td>12</td>
                        <td>13</td>
                      </tr>
                      <tr>
                        <td>14</td>
                        <td>15</td>
                        <td>16</td>
                        <td>17</td>
                        <td>18</td>
                        <td>19</td>
                        <td>20</td>
                      </tr>
                      <tr>
                        <td>21</td>
                        <td>22</td>
                        <td>23</td>
                        <td>24</td>
                        <td>25</td>
                        <td>26</td>
                        <td>27</td>
                      </tr>
                      <tr>
                        <td>28</td>
                        <td>29</td>
                        <td>30</td>
                        <td>31</td>
                        <td></td>
                        <td></td>
                        <td></td>
                      </tr>
                    </tbody>
                  </table>
                </p>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="card shadow-sm">
              <div class="card-body">
                <p class="text-center text-muted">September 2022</p>
                <p class="card-text">
                  <table class="table table-bordered">
                    <thead>
                      <tr>
                        <th scope="col">S</th>
                        <th scope="col">M</th>
                        <th scope="col">T</th>
                        <th scope="col">W</th>
                        <th scope="col">T</th>
                        <th scope="col">F</th>
                        <th scope="col">S</th>
                      </tr>
                    </thead>
                    <tbody class="table-group-divider">
                      <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td>1</td>
                        <td>2</td>
                        <td>3</td>
                      </tr>
                      <tr>
                        <td>4</td>
                        <td>5</td>
                        <td>6</td>
                        <td>7</td>
                        <td>8</td>
                        <td>9</td>
                        <td>10</td>
                      </tr>
                      <tr>
                        <td>11</td>
                        <td>12</td>
                        <td>13</td>
                        <td>14</td>
                        <td>15</td>
                        <td>16</td>
                        <td>17</td>
                      </tr>
                      <tr>
                        <td>18</td>
                        <td>19</td>
                        <td>20</td>
                        <td>21</td>
                        <td>22</td>
                        <td>23</td>
                        <td>24</td>
                      </tr>
                      <tr>
                        <td>25</td>
                        <td>26</td>
                        <td>27</td>
                        <td>28</td>
                        <td>29</td>
                        <td>30</td>
                        <td></td>
                      </tr>
                    </tbody>
                  </table>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>  

  <!-- Editing modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Edit parameters</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="word-input" class="col my-1 align-self-center">
            <form class="mx-2">
              <p class="mb-1">Deadline</p>
              <input id="deadline-input" placeholder="2022-09-30">
              <svg onclick="modalChangeDeadline()" style="cursor: pointer;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-right-circle" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/></svg>
              
              <p class="mb-1 mt-3">Target word count</p>
              <input id="target-count-input" type="number" placeholder="50000">
              <svg onclick="modalChangeTargetWordCount()" style="cursor: pointer;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-right-circle" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/></svg>
              
              <p class="mb-1 mt-3">Daily target</p>
              <input id="daily-target-input" type="number" placeholder="900">
              <svg onclick="modalChangeDailyTarget()" style="cursor: pointer;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-right-circle" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/></svg>
              
              <p class="mb-1 mt-3">Headline</p>
              <input id="headline-input" type="text" placeholder="Winner winner chicken dinner!">
              <svg onclick="modalChangeHeadline()" style="cursor: pointer;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-right-circle" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/></svg>
            </form>
          </div>
        </div>
        <div class="modal-footer">
          <p id="modal-done-text">Done!</p>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Footer -->
  <footer class="text-muted py-5">
    <div class="container">
      <p class="float-end mb-0">I love you.</p>
      <p class="mb-0">You got this.</p>
      <p class="text-center mb-0 pt-5 pb-0" onclick="firstSetup()" style="text-decoration: underline; cursor: pointer;"><small>reset.</small></p>
    </div>
  </footer>

  <script>
    function modalChangeDeadline() {
      let deadline = document.getElementById('deadline-input').value
      if (deadline.match(/\d{4}-\d{2}-\d{2}/)) {
        localStorage.setItem('deadline', deadline)
        document.getElementById('deadline-date').textContent = deadline
        calculateDaysLeft()
        changeModalCloseButton()
      }
    }
    function modalChangeTargetWordCount() {
      let targetCount = document.getElementById('target-count-input').value
      localStorage.setItem('target-words', targetCount)
      document.getElementById('total-words').textContent = targetCount
      calculateProgress()
      updateWordCount()
      changeModalCloseButton()
    }
    function modalChangeDailyTarget() {
      let dailyTarget = document.getElementById('daily-target-input').value
      localStorage.setItem('daily-target', dailyTarget)
      updateDailyTarget()
      changeModalCloseButton()
    }
    function modalChangeHeadline() {
      let headline = document.getElementById('headline-input').value
      localStorage.setItem('headline', headline)
      document.getElementById('headline').textContent = headline
      changeModalCloseButton()
    }
    function changeModalCloseButton() {
      $('#modal-done-text').fadeIn('slow')
      $('#modal-done-text').fadeOut('slow')
    }

    function firstSetup() {
      localStorage.setItem('words-written', 0)
      localStorage.setItem('days-passed', 0)
      localStorage.setItem('target-words', 50000)
      localStorage.setItem('daily-target', 900)
      localStorage.setItem('last-date', '2022-08-01')
      localStorage.setItem('deadline', '2022-09-30')
      localStorage.setItem('headline', "Let's do this!")
      calculateDaysLeft()
      calculateProgress()
      updateWordCount()
      updateDailyTarget()
    }

    function updateDailyTarget() {
      document.getElementById('daily-word-target').textContent = localStorage.getItem('daily-target')
    }

    function calculateDaysLeft() {
      const date = new Date();
      const deadline = new Date(localStorage.getItem('deadline'));
      const diffTime = Math.abs(deadline - date);
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      document.getElementById('days-left').textContent = diffDays
    }

    function daysPassed() {
      var date = new Date();
      var dated = new Date(date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate())
      var lastDate = new Date(localStorage.getItem('last-date'))
      var diffTimed = Math.abs(dated - lastDate);
      var diffDayss = Math.ceil(diffTimed / (1000 * 60 * 60 * 24));
      var oldDaysPassed = localStorage.getItem('days-passed')
      console.log(date);
      console.log(localStorage);
      console.log(dated);
      console.log(lastDate);
      console.log(diffTimed);
      console.log(diffDayss);
      console.log(oldDaysPassed);
      
      localStorage.setItem('days-passed', (parseInt(diffDayss) + parseInt(oldDaysPassed)))
      localStorage.setItem('last-date', dated.getFullYear() + '-' + (dated.getMonth() + 1) + '-' + dated.getDate())
      let tds = document.getElementsByTagName('td')
      let newDaysPassed = parseInt(localStorage.getItem('days-passed'))
      for (var i=0; i <= newDaysPassed; i++) {
        if (tds[i].textContent != '') {
          tds[i].classList.add('red')
        }
      }
      tds[newDaysPassed+1].classList.add('green')
    }
    
    function addWords(newWords) {
      let words = localStorage.getItem('words-written')
      words = parseInt(words) + parseInt(newWords)
      localStorage.setItem('words-written', words)
      updateWordCount()
      celebrate()
      document.getElementById('msg').classList.add('d-none')
      $("#yes-msg").fadeIn("slow");
      $("#yes-no-buttons").animate({"opacity": 0.01}, 800)
      $("button").prop("disabled",true);
      $("#change-word-count-btn").prop("disabled",false);
      $("#celebrate-btn").prop("disabled",false);
    }

    function updateWordCount() {
      document.getElementById('words-written').textContent = localStorage.getItem('words-written')
      let wordsLeft = parseInt(localStorage.getItem('target-words')) - parseInt(localStorage.getItem('words-written'))
      if (wordsLeft > 0) {
        document.getElementById('words-left').textContent = wordsLeft
      } else if (wordsLeft < 0) {
        document.getElementById('words-msg').textContent = "Hot damn! Blowing past the finish line. Love it."
        document.getElementById('msg').textContent = "CELEBRATIONS!"
        celebrate()
      } else {
        document.getElementById('words-msg').textContent = "YOU DID IT!!!"
        document.getElementById('msg').textContent = "CELEBRATIONS!"
        celebrate()
      }
      calculateProgress()
    }

    function toggleWordInput() {
      $('#change-word-count-btn').addClass('d-none')
      document.getElementById("word-input").classList.toggle('d-none')
    }

    function changeWordCount() {
      const words = document.getElementsByTagName('input')[0].value
      if (words.match(/^[0-9]+$/)) {
        const prevWords = localStorage.getItem('words-written')
        localStorage.setItem('words-written', words)
        updateWordCount()
        toggleWordInput()
        if (prevWords < words) {celebrate()}
        document.getElementsByTagName('input')[0].value = ''
        $('#change-word-count-btn').removeClass('d-none')
      } else {
        document.getElementsByTagName('input')[0].value = ''
      }
    }

    function calculateProgress() {
      let done = (100*parseInt(localStorage.getItem('words-written')))/parseInt(localStorage.getItem('target-words'))
      if (done <= 100) {
        document.getElementById("progress-done").style.width = done + '%'
        document.getElementById("progress-left").style.width = 100 - done + '%'
        document.getElementById("progress-done").textContent = done.toFixed(1) + '%'
        document.getElementById("progress-left").textContent = (100 - done).toFixed(1) + '%'
      } else {
        document.getElementById("progress-done").style.width = done + '%'
        document.getElementById("progress-done").textContent = (done).toFixed(1) + '%'
        document.getElementById("progress-left").style.width = 0
      }
    }
    
    function celebrate() {
      let xray = Math.random()
      confetti({
        particleCount: 100,
        spread: 70,
        origin: { y: 0.6, x: xray > 0.7 | xray < 0.3 ? 0.5 : xray }
      });
    }

    function noWords() {
      document.getElementById('msg').classList.add('d-none')
      const rando = Math.random()
      if (rando < 0.25) {
        $('#no-msg').text("You are amazing and I love you :*")
      } else if (rando < 0.5 && rando >= 0.25) {
        $('#no-msg').text("It's okay to rest sometimes :)")
      } else if (rando < 0.75 && rando >= 0.5) {
        $('#no-msg').text("Issokay you got this. Poopoo strong :*")
      }
      $("#no-msg").fadeIn("slow");
      $("#yes-no-buttons").animate({"opacity": 0.01}, 800)
      $("button").prop("disabled",true);
      $("#change-word-count-btn").prop("disabled",false);
      $("#celebrate-btn").prop("disabled",false);
    }

    // on each load
    var inputElements = document.getElementsByTagName("input");
    for (var ii=0; ii < inputElements.length; ii++) {
      inputElements[ii].value = "";
    }
    if (localStorage.length != 7) { 
      firstSetup()
    }
    document.getElementById('total-words').textContent = localStorage.getItem('target-words')
    document.getElementById('deadline-date').textContent = localStorage.getItem('deadline')
    document.getElementById('headline').textContent = localStorage.getItem('headline')
    // daysPassed()
    updateWordCount()
    calculateProgress()
    calculateDaysLeft()

    document.querySelector("#word-count-input").addEventListener("keydown", event => {
      if(event.key === "Enter") {changeWordCount();}
    });
    document.querySelector("#deadline-input").addEventListener("keydown", event => {
      if(event.key === "Enter") {modalChangeDeadline();}
    });
    document.querySelector("#target-count-input").addEventListener("keydown", event => {
      if(event.key === "Enter") {modalChangeTargetWordCount();}
    });
    document.querySelector("#daily-target-input").addEventListener("keydown", event => {
      if(event.key === "Enter") {modalChangeDailyTarget();}
    });
    document.querySelector("#headline-input").addEventListener("keydown", event => {
      if(event.key === "Enter") {modalChangeHeadline();}
    });
  </script>
</body>
</html>